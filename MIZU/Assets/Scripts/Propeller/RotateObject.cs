using System;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class RotateObject : MonoBehaviour
{
    [Header("1?b?????x???]??????")]
    [SerializeField] private float rotationSpeed = 90f;
    [Header("?Q?[???J?n?????????????]???n????????????????")]
    [SerializeField] private bool autoRotating = false;

    //  ???]???????????? 1???????A-1???t???]
    private int rotateDirection = 1;

    private bool isRotating = false;  //  ???]???t???O

    //  ???]?????????????????????m???????????C?x???g??????
    public event Action<RotateObject, bool> RotatingChange;

    //  ?????????]???????O???????????\??????
    public int RotateDirection => rotateDirection;

    //  ?I?u?W?F?N?g?????????]?????????????O???????????\??????
    public bool IsRotating => isRotating;

    void Start()
    {
        if (autoRotating)
        {
            StartRotation();
        }
    }

    //  ???]???J?n???????\?b?h
    public void StartRotation()
    {
        if (isRotating) return;

        isRotating = true;
        RotatingChange?.Invoke(this, isRotating);
    }


    void Update()
    {
        if (isRotating)
        {
            Vector3 rotateVec = rotateDirection * rotationSpeed * Time.deltaTime * Vector3.up;
            transform.Rotate(rotateVec);
        }
    }

    //  ???]??????????????
    public void SetRotationDirection(int direction)
    {
        if (direction != 1 && direction != -1)
        {
            Debug.LogError("???]??????(???????])??-1(?t???])????????????B");
            return;
        }

        if (rotateDirection != direction)
        {
            rotateDirection = direction;
            RotatingChange?.Invoke(this, isRotating);
        }
    }

}